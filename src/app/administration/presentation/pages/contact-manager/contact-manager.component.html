<p-toast position="bottom-right"></p-toast> 
<p-confirmDialog></p-confirmDialog> 

<div class="card p-3 md:p-5">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-2xl font-bold">Gesti√≥n de Contactos</h2>
    <div>
      <p-button
        label="Agregar"
        icon="pi pi-plus"
        (click)="openCreateContactDialog()"
        styleClass="p-button-info" 
      ></p-button>
    </div>
  </div>

  <div class="card">
    <div class="mb-4">
      <search-input 
        [label]="'Instancias / Instituciones'"
        (search)="onSearch($event)"
      />
    </div>
    
    <div class="overflow-x-auto"> 
      <p-table
        #dt
        [value]="contacts"
        [paginator]="true"
        [rows]="10"
        [responsiveLayout]="'stack'" 
        [globalFilterFields]="['instancia', 'instanceType.name', 'direccion']" 
        styleClass="p-datatable-sm p-datatable-striped"
      >
      
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="instancia">INSTANCIA <p-sortIcon field="instancia"></p-sortIcon></th>
            <th pSortableColumn="instanceType.name">INSTITUCION <p-sortIcon field="instanceType.name"></p-sortIcon></th>
            <th pSortableColumn="jefe">JEFE <p-sortIcon field="jefe"></p-sortIcon></th>
            <th pSortableColumn="soporte">SOPORTE <p-sortIcon field="soporte"></p-sortIcon></th>
            <th pSortableColumn="secretaria">SECRETARIA <p-sortIcon field="secretaria"></p-sortIcon></th>
            <th pSortableColumn="telefonoFijo">TELEFONO <p-sortIcon field="telefonoFijo"></p-sortIcon></th>
            <th pSortableColumn="direccion">DIRECCION <p-sortIcon field="direccion"></p-sortIcon></th>
            <th>Acciones</th>
          </tr>
        </ng-template>

       <ng-template pTemplate="body" let-contact>
        <tr>
          <td>{{ contact.instancia | uppercase }}</td>
          <td>{{ contact.instanceType?.name | uppercase }}</td>
          <td>{{ (contact.jefe || '') | uppercase }}</td>
          <td>{{ (contact.soporte || '') | uppercase }}</td>
          <td>{{ (contact.secretaria || '') | uppercase }}</td>
          <td>{{ (contact.telefonoFijo || '') | uppercase }}</td>
          <td>{{ (contact.direccion || '') | uppercase }}</td>
          <td>
            <div class="flex justify-center gap-2">
              <button
                pButton
                pRipple
                icon="pi pi-pencil"
                class="p-button-rounded p-button-text p-button-sm"
                (click)="openEditContactDialog(contact)"
              ></button>
              <button
                pButton
                pRipple
                icon="pi pi-trash"
                class="p-button-rounded p-button-text p-button-sm p-button-danger"
                (click)="deleteContact(contact)"
              ></button>
            </div>
          </td>
        </tr>
        </ng-template>



        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="8" class="text-center">No se encontraron contactos.</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>