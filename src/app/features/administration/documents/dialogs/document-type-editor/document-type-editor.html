<form [formGroup]="documentTypeForm" (ngSubmit)="save()">
  <div class="flex flex-col gap-1">
    <input
      pInputText
      type="text"
      formControlName="name"
      placeholder="Nombre"
      class="w-full"
    />
    @if(isInvalid("name")){
    <p-message severity="error" size="small" variant="simple">
      {{ documentTypeForm.get("name")?.errors | formErrorMessages }}
    </p-message>
    }
  </div>
  <div class="flex items-center justify-between p-2 mt-2">
    <span class="font-medium text-lg">Subtipos </span>
    <p-button
      icon="pi pi-plus"
      size="small"
      label="Agregar"
      (click)="addSubType()"
    />
  </div>
  <div
    class="flex flex-col gap-y-6 p-4 border rounded-lg border-slate-300"
    formArrayName="subTypes"
  >
    @for (subtype of subTypes.controls; track $index; let i = $index) {
    <div [formGroupName]="i" class="flex items-center gap-x-2">
      <div class="flex-1">
        <p-floatlabel variant="on">
          <label> {{ i + 1 }}. Nombre subtipo</label>
          <input pInputText class="w-full" formControlName="name" />
        </p-floatlabel>
      </div>
      <p-button icon="pi pi-trash" [rounded]="true" [text]="true" (onClick)="removeSubType(i)" />
    </div>
    } @empty {
    <div>Sin subtipos.</div>
    }
  </div>

  <div class="p-dialog-footer">
    <p-button label="Cancelar" severity="secondary" (onClick)="close()" />
    <p-button
      type="submit"
      label="Guardar"
      [disabled]="documentTypeForm.invalid"
    />
  </div>
</form>
