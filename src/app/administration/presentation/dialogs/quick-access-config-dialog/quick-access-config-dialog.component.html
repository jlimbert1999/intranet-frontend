<form [formGroup]="form" (ngSubmit)="save()">
  <div class="flex items-center justify-end p-2">
    <p-button
      icon="pi pi-plus"
      size="small"
      label="Agregar"
      (click)="imageInput.click()"
    />
    <input
      #imageInput
      type="file"
      [hidden]="true"
      [multiple]="true"
      accept="image/png, image/jpeg, image/jpg"
      (change)="onFileSelected($event)"
    />
  </div>
  <div
    cdkDropList
    (cdkDropListDropped)="drop($event)"
    class="flex flex-col gap-y-4 max-h-[600px] p-4 overflow-y-auto border border-slate-300"
    formArrayName="items"
  >
    <div
      *ngFor="let control of itemsFormArray.controls; let i = index"
      [formGroupName]="i"
      cdkDrag
    >
      <div class="flex flex-col relative bg-surface-0 rounded-xl shadow-md border border-surface-200 px-4 py-2">
        <div class="flex justify-between mb-2">
          <div class="flex items-center gap-x-2">
            <div class="font-semibold">Nro. {{ i + 1 }}</div>
          </div>
          <div class="flex gap-x-2">
            <p-button cdkDragHandle icon="pi pi-arrows-alt" size="small" [text]="true" />
            <p-button
              icon="pi pi-trash"
              severity="danger"
              size="small"
              (onClick)="removeSlide(i)"
            />
          </div>
        </div>
        <div class="flex flex-col sm:flex-row items-center gap-x-4">
          <div class="w-full sm:w-[100px] h-20 rounded-xl bg-surface-100 flex items-center justify-center mb-2 group-hover:bg-primary-50">
              <img
                [src]="quickAccessItems()[i].icon"
                [alt]="quickAccessItems()[i].icon"
                class="w-12 h-12 object-contain"
                loading="lazy"
              />
          </div>
          <div class="w-full flex flex-col gap-4">
            <p-floatlabel variant="on">
              <label>Nombre</label>
              <input pInputText class="w-full" formControlName="name" />
            </p-floatlabel>
            <p-floatlabel variant="on">
              <label>Link</label>
              <input pInputText class="w-full" formControlName="url" />
            </p-floatlabel>
          </div>
        </div>
      </div>
    </div>
    @if(quickAccessItems().length===0){
      <div class="font-medium">No se encontraron elementos.</div>
    }
  </div>
  <div class="p-dialog-footer">
    <button pButton severity="secondary" type="button" (click)="close()">
      <span pButtonLabel>Cancelar</span>
    </button>
    <button pButton type="submit" [disabled]="form.invalid">
      <span pButtonLabel>Guardar</span>
    </button>
  </div>
</form>
